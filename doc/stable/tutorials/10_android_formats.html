<!doctypehtml><html data-content_root=../ lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0 name=viewport><meta content=width=device-width,initial-scale=1 name=viewport><meta content=width=device-width,initial-scale=1 name=viewport><meta content=ie=edge http-equiv=x-ua-compatible><meta content="Copy to clipboard"name=lang:clipboard.copy><meta content="Copied to clipboard"name=lang:clipboard.copied><meta content=en name=lang:search.language><meta content=True name=lang:search.pipeline.stopwords><meta content=True name=lang:search.pipeline.trimmer><meta content="No matching documents"name=lang:search.result.none><meta content="1 matching document"name=lang:search.result.one><meta content="# matching documents"name=lang:search.result.other><meta content=[\s\-]+ name=lang:search.tokenizer><meta content="LIEF Documentation"name=Description><link crossorigin href=https://fonts.gstatic.com/ rel=preconnect><script src=../_static/javascripts/vendor.min.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css rel=stylesheet><link href=../_static/favicon.ico rel=apple-touch-icon><title>10 - Android formats — LIEF Documentation</title><link href=../_static/fonts/material-icons.css rel=stylesheet><link href=../_static/fonts/font-awesome.css rel=stylesheet><link href=../_static/stylesheets/vendor.min.css rel=stylesheet><link href=../_static/pygments.css?v=3d3fbe02 rel=stylesheet><link href=../_static/basic.css?v=eeb27264 rel=stylesheet><link href=../_static/graphviz.css?v=eafc0fe6 rel=stylesheet><link href=../_static/css/custom.css?v=d79dd603 rel=stylesheet><script src=../_static/documentation_options.js?v=6b213311></script><script src=../_static/doctools.js?v=888ff710></script><script src=../_static/sphinx_highlight.js?v=dc90522c></script><link href=../_static/favicon.ico rel=icon><link href=../genindex.html rel=index title=Index><link href=../search.html rel=search title=Search><link title="11 - Mach-O Modification"href=11_macho_modification.html rel=next><link title="09 - How to use frida on a non-rooted device"href=09_frida_lief.html rel=prev><link href=../_static/stylesheets/theme.css rel=stylesheet><link href=../_static/stylesheets/theme-fixes.css rel=stylesheet><body data-md-color-accent=cyan data-md-color-primary=blue dir=ltr><nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom fixed-top"role=navigation><a class=navbar-brand href=../index.html>LIEF Documentation</a><button class=navbar-toggler data-target=#navbar-collapse data-toggle=collapse><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-center mt-2 mt-lg-0"id=navbar-collapse><ul class="navbar-nav position-relative px-lg-6 px-xl-8"><li class=nav-item><a class=nav-link href=https://lief-project.github.io/> <i class="fa-solid fa-house mr-3"></i>Home </a><li class=nav-item><a class=nav-link href=https://lief-project.github.io//blog> <i class="fa-solid fa-rss mr-3"></i>Blog </a><li class=nav-item><a class=nav-link href=https://lief-project.github.io//download> <i class="fa-solid fa-download mr-3"></i>Download </a><li class="nav-item dropdown"><a class="nav-link dropdown-toggle"aria-expanded=false data-toggle=dropdown href=# role=button> <i class="fa-solid fa-book mr-3"></i>Documentation </a> <div class=dropdown-menu role=menu><a class=dropdown-item href=https://lief-project.github.io//doc/stable/doxygen>Doxygen</a></div><li class=nav-item><a class=nav-link href=https://lief-project.github.io//about> <i class="fa-solid fa-bars-staggered mr-3"></i>About </a><li class=nav-item><a class="btn btn-outline-pink"href=https://github.com/sponsors/lief-project/ target=_blank> <i class="fa-solid fa-heart mr-3"></i> Sponsor </a></ul></div></nav><div class="container-fluid container-docs"><div class=row><div class="col-12 col-lg-3 col-xl-2 border-lg-right py-lg-5 pl-lg-4 docs-sidebar docs-sidebar-left"><div class="collapse d-lg-block mb-6 mb-lg-0"id=sidebar-collapse><form action=../search.html method=GET name=search><input autocapitalize=off autocomplete=off class=form-control data-md-component=query data-md-state=active name=q placeholder=Search spellcheck=false></form><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../intro.html>Introduction</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../installation.html>Installation and Integration</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../getting_started.html>Getting Started</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../compilation.html>Compilation</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../error_handling.html>Error Handling</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text>Tutorials</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=01_play_with_formats.html>01 - Parse and manipulate formats</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=02_pe_from_scratch.html>02 - Create a PE from scratch</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=03_elf_change_symbols.html>03 - Play with ELF symbols</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=04_elf_hooking.html>04 - ELF Hooking</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=05_elf_infect_plt_got.html>05 - Infecting the plt/got</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=06_pe_hooking.html>06 - PE Hooking (Deprecated)</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=07_pe_resource.html>07 - PE Resources</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=08_elf_bin2lib.html>08 - Transforming an ELF executable into a library</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=09_frida_lief.html>09 - How to use frida on a non-rooted device</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=#>10 - Android formats</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=11_macho_modification.html>11 - Mach-O Modification</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=12_elf_coredump.html>12 - ELF Coredump</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=13_pe_authenticode.html>13 - PE Authenticode</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text>API</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../api/python/index.html>Python</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../api/cpp/index.html>C++</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../api/c/index.html>C</a></ul><div class="text-darkblue text-uppercase font-size-normal font-weight-bolder mt-4 pt-2 mb-2"><span class=caption-text>Extra Information</span></div><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../formats/index.html>Formats</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../references.html>References</a></ul><ul class="list-unstyled mt-3"><li><a class="text-darkblue font-size-sm d-block mb-2"href=../changelog.html>Changelog</a></ul></div><hr><span class="svg-icon text-purple mr-1 relative-top--1"> <svg viewbox="0 0 512 512"height=512 width=512 xmlns=http://www.w3.org/2000/svg><title>ionicons-v5-d</title><circle cx=160 cy=96 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><circle cx=160 cy=416 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><line style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px x1=160 x2=160 y1=368 y2=144></line><circle cx=352 cy=160 r=48 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></circle><path d=M352,208c0,128-192,48-192,160 style=fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px></path></svg> </span><a class=text-darkblue href=https://github.com/lief-project/LIEF/commits/bae887e0>0.14.1</a><br> Last updated on 11/02/2024, 18:59:55.</div><div class="col-12 col-lg-9 col-xl-8 offset-lg-3 offset-xl-2 py-lg-5 px-lg-6 mb-8"><section id=android-formats><h1 id=tutorials-10-android-formats--page-root>10 - Android formats<a title="Link to this heading"class=headerlink href=#tutorials-10-android-formats--page-root>¶</a></h1><p>This tutorial introduces Android formats as well as the API to use them. We are talking about DEX, OAT, VDEX and ART.<p>Files used in this tutorial are available on the <a class="reference external"href=https://github.com/lief-project/tutorials/tree/master/10_android_formats>tutorials repository</a><p>By Romain Thomas - <a class="reference external"href=https://twitter.com/rh0main>@rh0main</a><hr class=docutils><section id=introduction><h2 id=introduction>Introduction<a title="Link to this heading"class=headerlink href=#introduction>¶</a></h2><p>Let’s start with a quick reminder about <em>compilation</em>, installation and the execution of Android applications.<p>When dealing with application development, the main part of the code is usually written in Java. Developers can also write native code (<code class="docutils literal notranslate"><span class=pre>C/C++</span></code>) through the Java Native Interface (JNI) interface.<p>In the APK building process, the Java code is eventually transformed in the Dalvik bytecode which is interpreted by the Android Java virtual machine. The Android JVM is different from the implementation by Oracle and, among the differences, it is based on registers whereas the one from Oracle is based on a stack.<p>To produce the Dalvik bytecode, Java sources are first compiled with <code class="docutils literal notranslate"><span class=pre>javac</span></code> into the Java bytecode and then Android transforms this bytecode into the Dalvik one by using the <code class="docutils literal notranslate"><span class=pre>dx</span></code> compiler (or the new one: <code class="docutils literal notranslate"><span class=pre>D8</span></code>). This bytecode is finally wrapped in a DEX file(s) such as <code class="docutils literal notranslate"><span class=pre>classes.dex</span></code>. The DEX format is specific to Android and the documentation is available <a class="reference external"href=https://source.android.com/devices/tech/dalvik/dex-format>here</a>.<p>During the installation of the APK, the system applies optimizations on this DEX file in order to speed-up the execution. Indeed interpreting bytecode is not as efficient as executing native code and the Dalvik virtual machine is based on registers that are 32-bits width size whereas most of the recent CPU are 64-bits width.<p>To address this issue and prior to Android 4.4 (KitKat), the runtime used JIT compilation to transform Dalvik bytecode into assembly. The JIT ocurred <strong>during the execution</strong> and it was done each time the application was executed. Since Android 4.4 they moved to a new runtime which, among other features, performs the optimizations <strong>during the installation</strong>. Consequently the installation takes more time but transformations to native code are done once.<p>To optimize the Dalvik bytecode, the original DEX file (e.g. <code class="docutils literal notranslate"><span class=pre>classes.dex</span></code>) is transformed into another file that will contain the native code. This new file usually has the <code class="docutils literal notranslate"><span class=pre>.odex</span></code>, <code class="docutils literal notranslate"><span class=pre>.oat</span></code> extension and is wrapped by the ELF format. Using ELF format makes sense for mainly two reasons:<ul class=simple><li><p>It’s the default format used by Linux and Android to <em>package</em> assembly code.<li><p>It enables to use the same loader: <code class="docutils literal notranslate"><span class=pre>/system/bin/linker{64}</span></code></ul><p>OAT files are in fact ELF and this is why, we choose to add this new format in LIEF. This ELF format is actually used as a wrapper over another format which is specific to Android: the OAT format.<p>Basically the ELF associated exports few symbols:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=kn>import</span> <span class=nn>lief</span>

<span class=n>oat</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"SomeOAT"</span><span class=p>)</span>
<span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>oat</span><span class=o>.</span><span class=n>dynamic_symbols</span><span class=p>:</span>
  <span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</pre></div></div><div class="highlight-text notranslate"><div class=highlight><pre><span></span>oatdata                       OBJECT    GLOBAL    1000      1262000
oatexec                       OBJECT    GLOBAL    1263000   10d4060
oatlastword                   OBJECT    GLOBAL    233705c   4
oatbss                        OBJECT    GLOBAL    2338000   f5050
oatbsslastword                OBJECT    GLOBAL    242d04c   4
</pre></div></div><p>These symbols are a kind of pointers to specific part of the OAT format. For example, <code class="docutils literal notranslate"><span class=pre>oatdata</span></code> will point to the begining of the underlying OAT format whereas <code class="docutils literal notranslate"><span class=pre>oatexec</span></code> points to the native code. For those who are interested in a deeper understand of OAT internal structures, See:<ul class=simple><li><p><a class="reference external"href=https://www.blackhat.com/docs/asia-15/materials/asia-15-Sabanal-Hiding-Behind-ART-wp.pdf>Hiding Behind ART - Black Hat 2015</a><li><p><a class="reference external"href=http://newandroidbook.com/files/ArtOfDalvik.pdf>Dalvik and ART</a><li><p><a class="reference external"href=http://romainthomas.fr/oat/>OAT internal structures</a></ul><p>These different formats can be a bit confusing and to summarize:<p class=centered><strong>DEX are transformed into <code class="docutils literal notranslate"><span class=pre>.odex</span></code> files that are primarily ELF files wrapping a custom OAT format.</strong><figure class=align-center><a class="reference internal image-reference"href=../_images/elf_oat.png><img style="width: 512.0px; height: 248.5px;"alt=../_images/elf_oat.png src=../_images/elf_oat.png></a></figure><p>The structure of the OAT is poorly documented and its internal structures change for <strong>each version</strong> of Android without backward compatibility. It means that OAT files produced on Android 6.0.1 can only be used on this version.<hr class=docutils><p>In the Android framework the <code class="docutils literal notranslate"><span class=pre>dex2oat</span></code> executable is responsible to convert and optimize the APK DEX files into OATs. This executable is located in the <code class="docutils literal notranslate"><span class=pre>/system/bin/</span></code> directory and we can have its output through logcat:<div class="highlight-console notranslate"><div class=highlight><pre><span></span><span class=gp>$ </span>adb<span class=w> </span>logcat<span class=w> </span>-s<span class=w> </span><span class=s2>"dex2oat:I"</span>
<span class=go>...</span>
<span class=go>05-04 10:16:37.218  1987  1987 I dex2oat : /system/bin/dex2oat --compiler-filter=speed --dex-file=/data/user/0/com.google.android.gms/snet/installed/snet.jar --oat-file=/data/user/0/com.google.android.gms/snet/dalvik-cache/snet.dex</span>
<span class=go>05-04 10:16:37.688  1987  1998 W dex2oat : Compilation of void com.google.android.snet.Snet.enterSnetIdle(android.content.Context, android.os.Bundle) took 116.995ms</span>
<span class=go>05-04 10:16:37.768  1987  1987 I dex2oat : ----------------------------------------------------</span>
<span class=go>05-04 10:16:37.768  1987  1987 I dex2oat : &LTSS>: S T A R T I N G . . .</span>
<span class=go>05-04 10:16:37.768  1987  1987 E dex2oat : &LTSS>: oat location is not valid /data/user/0/com.google.android.gms/snet/dalvik-cache/snet.dex</span>
<span class=go>05-04 10:16:37.768  1987  1987 I dex2oat : dex2oat took 552.045ms (threads: 8) arena alloc=3MB java alloc=1150KB native alloc=8MB free=3MB</span>
<span class=go>05-04 12:25:50.878 10460 10460 I dex2oat : /system/bin/dex2oat --compiler-filter=speed</span>
<span class=go>...</span>
</pre></div></div><p>The output above is the transformation of SaftyNet DEX files, located in <code class="docutils literal notranslate"><span class=pre>/data/user/0/com.google.android.gms/snet/installed/snet.jar</span></code>, into an <strong>OAT</strong> saved in <code class="docutils literal notranslate"><span class=pre>/data/user/0/com.google.android.gms/snet/dalvik-cache/snet.dex</span></code>.<p>One can notice that the extension is <code class="docutils literal notranslate"><span class=pre>.dex</span></code> so it should be a DEX file and not an OAT. Actually if we check the type:<div class="highlight-console notranslate"><div class=highlight><pre><span></span><span class=gp>$ </span>file<span class=w> </span>snet.dex
<span class=go>snet.dex: ELF 64-bit LSB shared object, ARM aarch64, version 1 (GNU/Linux), dynamically linked, stripped</span>
</pre></div></div><p>We can see an ELF.<div class="admonition warning"><p class=admonition-title>Warning<p>Do not trust extensions: <strong>.dex</strong> can be <strong>DEX</strong> or <strong>OAT</strong>, <strong>.odex</strong> are <strong>OAT</strong>, <strong>.oat</strong> are <strong>OAT</strong>, …</div><p>The process of converting Java sources into the OAT can be simplified with the following diagram:<figure class=align-center><img alt=../_images/java2oat.png src=../_images/java2oat.png></figure></section><section id=the-missing-dex><h2 id=the-missing-dex>The Missing DEX<a title="Link to this heading"class=headerlink href=#the-missing-dex>¶</a></h2><p>If we analyze applications from the Google PlayStore, we usually have the <code class="docutils literal notranslate"><span class=pre>classes.dex</span></code> file(s) in APK. As this file contains the Dalvik bytecode, most of the tools rely on this file to perform the analysis (decompilation, static analysis, …)<p>However when analyzing constructor firmwares (or ROM) these DEX files could miss. For example, if we are interested in <code class="docutils literal notranslate"><span class=pre>com.android.settings</span></code> from Samsung, the application is associated with the <code class="docutils literal notranslate"><span class=pre>/system/priv-app/SecSettings2</span></code> directory which has the following structure:<div class="highlight-console notranslate"><div class=highlight><pre><span></span><span class=gp>$ </span>tree<span class=w> </span>system/priv-app/SecSettings2

<span class=go>├── oat</span>
<span class=go>│   └── arm64</span>
<span class=go>│       └── SecSettings2.odex</span>
<span class=go>└── SecSettings2.apk</span>

<span class=go>2 directories, 2 files</span>
</pre></div></div><p>By looking at the files in <code class="docutils literal notranslate"><span class=pre>SecSettings2.apk</span></code>, we can’t find <code class="docutils literal notranslate"><span class=pre>.dex</span></code> files:<div class="highlight-console notranslate"><div class=highlight><pre><span></span><span class=gp>$ </span>unzip<span class=w> </span>-l<span class=w> </span>./SecSettings2.apk<span class=p>|</span>grep<span class=w> </span>-c<span class=w> </span><span class=s2>"classes.dex"</span>
<span class=go>0</span>
</pre></div></div><p>Next to the <code class="docutils literal notranslate"><span class=pre>SecSettings2.apk</span></code>, we find <code class="docutils literal notranslate"><span class=pre>SecSettings2.odex</span></code> which is the OAT file resulting of the optimization of the missing DEX file. As ROM developers control the Android <strong>version</strong> and the target architecture, they just have to provide the OAT file.<p>They can also use this <em>“feature”</em> to avoid analysis and reverse engineering of the application. As the Dalvik bytecode is located in the DEX file, without this file the analysis is quite limited.<p>Thankfully there is a copy of the original DEX within the OAT! Actually it’s not an exact copy as <code class="docutils literal notranslate"><span class=pre>dex2oat</span></code> replaces some Dalvik instructions (like <code class="docutils literal notranslate"><span class=pre>invoke-virtual</span></code>) with optimized ones <a class="footnote-reference brackets"href=#id9 id=id1 role=doc-noteref><span class=fn-bracket>[</span>1<span class=fn-bracket>]</span></a> but starting from <strong>Android N</strong>, we can also recover the original instructions.<p>Prior Android Oreo (8.0.0) DEX files were embedded in the OAT itself and after Oreo, the transformation performed by <code class="docutils literal notranslate"><span class=pre>dex2oat</span></code> generates two files:<ul class=simple><li><p><strong>classes.odex</strong>: OAT containing native code<li><p><strong>classes.vdex</strong>: VDEX file containing copy of original DEX files</ul><p>The DEX files originally located in the OAT has been exported <strong>in a new file</strong> with <strong>a new format</strong>: the VDEX format. This new format is completely different from OAT, especially it’s not an ELF.<p>In the same way as OAT format, VDEX internal structures change for each version of Android without backward compatibility.<p>It also exists tools <a class="footnote-reference brackets"href=#id12 id=id2 role=doc-noteref><span class=fn-bracket>[</span>4<span class=fn-bracket>]</span></a> <a class="footnote-reference brackets"href=#id13 id=id3 role=doc-noteref><span class=fn-bracket>[</span>5<span class=fn-bracket>]</span></a> <a class="footnote-reference brackets"href=#id14 id=id4 role=doc-noteref><span class=fn-bracket>[</span>6<span class=fn-bracket>]</span></a> to extract DEX from OAT/VDEX files but the <strong>extraction</strong> <a class="footnote-reference brackets"href=#id11 id=id5 role=doc-noteref><span class=fn-bracket>[</span>3<span class=fn-bracket>]</span></a> is either limited to OAT <a class="footnote-reference brackets"href=#id12 id=id6 role=doc-noteref><span class=fn-bracket>[</span>4<span class=fn-bracket>]</span></a> or to VDEX <a class="footnote-reference brackets"href=#id13 id=id7 role=doc-noteref><span class=fn-bracket>[</span>5<span class=fn-bracket>]</span></a>. With LIEF we aim to provide a single framework to deal with these formats.</section><section id=oat-and-vdex><h2 id=oat-and-vdex>OAT and VDEX<a title="Link to this heading"class=headerlink href=#oat-and-vdex>¶</a></h2><p>As explained in the previous part, internal structures of the formats change for each version of Android. LIEF provides an abstraction of these modifications and the user can deal with OAT or VDEX without carrying of the underlying version of the OAT.<p>It currently supports OAT files from Android 6.0 Marshmallow (OAT v64) to Android 8.0.1 Oreo (OAT v131).<p>The OAT version is available with the <a class="reference internal"href=../api/python/oat.html#lief.OAT.version title=lief.OAT.version><code class="xref py py-func docutils literal notranslate"><span class=pre>lief.OAT.version()</span></code></a> function:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=kn>import</span> <span class=nn>lief</span>
<span class=gp>>>> </span><span class=n>lief</span><span class=o>.</span><span class=n>OAT</span><span class=o>.</span><span class=n>version</span><span class=p>(</span><span class=s2>"classes.odex"</span><span class=p>)</span> <span class=c1># From Android 6</span>
<span class=go>64</span>
<span class=gp>>>> </span><span class=n>lief</span><span class=o>.</span><span class=n>OAT</span><span class=o>.</span><span class=n>version</span><span class=p>(</span><span class=s2>"classes.odex"</span><span class=p>)</span> <span class=c1># From Android 7</span>
<span class=go>88</span>
</pre></div></div><p>One can also access to the associated Android version by using <a class="reference internal"href=../api/python/oat.html#lief.OAT.android_version title=lief.OAT.android_version><code class="xref py py-func docutils literal notranslate"><span class=pre>lief.OAT.android_version()</span></code></a>:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=n>lief</span><span class=o>.</span><span class=n>OAT</span><span class=o>.</span><span class=n>android_version</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span>
<span class=go>ANDROID_VERSIONS.VERSION_601</span>
<span class=gp>>>> </span><span class=n>lief</span><span class=o>.</span><span class=n>OAT</span><span class=o>.</span><span class=n>android_version</span><span class=p>(</span><span class=mi>124</span><span class=p>)</span>
<span class=go>ANDROID_VERSIONS.VERSION_800</span>
<span class=gp>>>> </span><span class=n>lief</span><span class=o>.</span><span class=n>Android</span><span class=o>.</span><span class=n>code_name</span><span class=p>(</span><span class=n>lief</span><span class=o>.</span><span class=n>Android</span><span class=o>.</span><span class=n>ANDROID_VERSIONS</span><span class=o>.</span><span class=n>VERSION_800</span><span class=p>)</span>
<span class=go>'Oreo'</span>
<span class=gp>>>> </span><span class=n>lief</span><span class=o>.</span><span class=n>Android</span><span class=o>.</span><span class=n>version_string</span><span class=p>(</span><span class=n>lief</span><span class=o>.</span><span class=n>Android</span><span class=o>.</span><span class=n>ANDROID_VERSIONS</span><span class=o>.</span><span class=n>VERSION_800</span><span class=p>)</span>
<span class=go>"8.0.0"</span>
</pre></div></div><p>To express the fact that OAT files are first ELF, the <a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary title=lief.OAT.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.OAT.Binary</span></code></a> class extends the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary title=lief.ELF.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.ELF.Binary</span></code></a><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=kn>import</span> <span class=nn>lief</span>
<span class=gp>>>> </span><span class=n>oat</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"classes.odex"</span><span class=p>)</span>
<span class=gp>>>> </span><span class=nb>type</span><span class=p>(</span><span class=n>oat</span><span class=p>)</span>
<span class=go>_pylief.OAT.Binary</span>
<span class=gp>>>> </span><span class=nb>isinstance</span><span class=p>(</span><span class=n>oat</span><span class=p>,</span> <span class=n>lief</span><span class=o>.</span><span class=n>ELF</span><span class=o>.</span><span class=n>Binary</span><span class=p>)</span>
<span class=go>True</span>
</pre></div></div><p>Thus the same ELF API is available: adding sections, modifying dynamic entries, etc and the <a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary title=lief.OAT.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.OAT.Binary</span></code></a> object adds the following methods:<dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-prename descclassname"><span class=pre>lief.OAT.</span></span><span class="sig-name descname"><span class=pre>Binary</span></span><dd><p>OAT binary representation</p> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>FORMATS</span></span><dd><dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>ELF</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.FORMATS.ELF</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>MACHO</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.FORMATS.MACHO</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>OAT</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.FORMATS.OAT</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>PE</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.FORMATS.PE</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>UNKNOWN</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.FORMATS.UNKNOWN</span></em><dd></dl></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>PHDR_RELOC</span></span><dd><dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>AUTO</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.ELF.PHDR_RELOC.AUTO</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>BSS_END</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.ELF.PHDR_RELOC.BSS_END</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>FILE_END</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.ELF.PHDR_RELOC.FILE_END</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>PIE_SHIFT</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.ELF.PHDR_RELOC.PIE_SHIFT</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>SEGMENT_GAP</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.ELF.PHDR_RELOC.SEGMENT_GAP</span></em><dd></dl></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>VA_TYPES</span></span><dd><dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>AUTO</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.VA_TYPES.AUTO</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>RVA</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.VA_TYPES.RVA</span></em><dd></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>VA</span></span><em class=property><span class=w> </span><span class=p><span class=pre>=</span></span><span class=w> </span><span class=pre>lief._lief.VA_TYPES.VA</span></em><dd></dl></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>abstract</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/abstract.html#lief.Binary title=lief.Binary><span class=pre>lief.Binary</span></a></span></span><dd><p>Return the abstract representation of the current binary (<a class="reference internal"href=../api/python/abstract.html#lief.Binary title=lief.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.Binary</span></code></a>)</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><span class=pre>lief.ELF.Section</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><span class=pre>lief.ELF.Note</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief.ELF.DynamicEntry><span class=pre>lief.ELF.DynamicEntry</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>add(self,</span> <span class=pre>arg:</span> <span class=pre>lief._lief.ELF.DynamicEntry,</span> <span class=pre>/)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.DynamicEntry</span></code></ol> <p>dynamic_entry</p> <ol class=arabic start=2><li><p><code class="docutils literal notranslate"><span class=pre>add(self,</span> <span class=pre>section:</span> <span class=pre>lief._lief.ELF.Section,</span> <span class=pre>loaded:</span> <span class=pre>bool</span> <span class=pre>=</span> <span class=pre>True)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Section</span></code></p> <blockquote><div><p>Add the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> to the binary.<p>If the section does not aim at being loaded in memory, the <code class="docutils literal notranslate"><span class=pre>loaded</span></code> parameter has to be set to <code class="docutils literal notranslate"><span class=pre>False</span></code> (default: <code class="docutils literal notranslate"><span class=pre>True</span></code>)</div></blockquote><li><p><code class="docutils literal notranslate"><span class=pre>add(self,</span> <span class=pre>segment:</span> <span class=pre>lief._lief.ELF.Segment,</span> <span class=pre>base:</span> <span class=pre>int</span> <span class=pre>=</span> <span class=pre>0)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Segment</span></code></ol> <p>Add a new <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> in the binary</p> <ol class="arabic simple"start=4><li><p><code class="docutils literal notranslate"><span class=pre>add(self,</span> <span class=pre>note:</span> <span class=pre>lief._lief.ELF.Note)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Note</span></code></ol> <p>Add a new <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><code class="xref py py-class docutils literal notranslate"><span class=pre>Note</span></code></a> in the binary</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add_dynamic_relocation</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>relocation</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><span class=pre>lief.ELF.Relocation</span></a></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><span class=pre>lief.ELF.Relocation</span></a></span></span><dd><p>Add a new <em>dynamic</em> relocation.</p> <p>We consider a dynamic relocation as a relocation which is not plt-related.</p> <p>See: <a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.add_pltgot_relocation title=lief.ELF.Binary.add_pltgot_relocation><code class="xref py py-meth docutils literal notranslate"><span class=pre>lief.ELF.Binary.add_pltgot_relocation()</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add_dynamic_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></em>, <em class=sig-param><span class=n><span class=pre>symbol_version</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersion title=lief.ELF.SymbolVersion><span class=pre>lief.ELF.SymbolVersion</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><span class=pre>None</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></span><dd><p>Add a <strong>dynamic</strong> <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> to the binary</p> <p>The function also takes an optional <a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersion title=lief.ELF.SymbolVersion><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.ELF.SymbolVersion</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add_exported_function</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>address</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em>, <em class=sig-param><span class=n><span class=pre>name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></span><dd><p>Create a symbol for the function at the given <code class="docutils literal notranslate"><span class=pre>address</span></code> and create an export</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add_library</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>library_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntryLibrary title=lief.ELF.DynamicEntryLibrary><span class=pre>lief.ELF.DynamicEntryLibrary</span></a></span></span><dd><p>Add a library with the given name as dependency</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add_object_relocation</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>relocation</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><span class=pre>lief.ELF.Relocation</span></a></span></em>, <em class=sig-param><span class=n><span class=pre>section</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><span class=pre>lief.ELF.Section</span></a></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><span class=pre>lief.ELF.Relocation</span></a></span></span><dd><p>Add relocation for object file (.o)</p> <p>The first parameter is the section to add while the second parameter is the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> associated with the relocation.</p> <p>If there is an error, this function returns a nullptr. Otherwise, it returns the relocation added.”,</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add_pltgot_relocation</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>relocation</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><span class=pre>lief.ELF.Relocation</span></a></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><span class=pre>lief.ELF.Relocation</span></a></span></span><dd><p>Add a .plt.got relocation. This kind of relocation is usually associated with a PLT stub that aims at resolving the underlying symbol.</p> <p>See: <a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.add_dynamic_relocation title=lief.ELF.Binary.add_dynamic_relocation><code class="xref py py-meth docutils literal notranslate"><span class=pre>lief.ELF.Binary.add_dynamic_relocation()</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>add_static_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></span><dd><p>Add a <strong>static</strong> <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> to the binary</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>classes</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary.it_classes title=lief.OAT.Binary.it_classes><span class=pre>lief.OAT.Binary.it_classes</span></a></span></span><dd><p>Return an iterator over <a class="reference internal"href=../api/python/oat.html#lief.OAT.Class title=lief.OAT.Class><code class="xref py py-class docutils literal notranslate"><span class=pre>Class</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>concrete</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary title=lief.ELF.Binary><span class=pre>lief.ELF.Binary</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/pe.html#lief.PE.Binary title=lief.PE.Binary><span class=pre>lief.PE.Binary</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/macho.html#lief.MachO.Binary title=lief.MachO.Binary><span class=pre>lief.MachO.Binary</span></a></span></span><dd><p>The <em>concrete</em> representation of the binary. Basically, this property cast a <a class="reference internal"href=../api/python/abstract.html#lief.Binary title=lief.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.Binary</span></code></a> into a <a class="reference internal"href=../api/python/pe.html#lief.PE.Binary title=lief.PE.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.PE.Binary</span></code></a>, <a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary title=lief.ELF.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.ELF.Binary</span></code></a> or <a class="reference internal"href=../api/python/macho.html#lief.MachO.Binary title=lief.MachO.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.MachO.Binary</span></code></a>.</p> <p>See also: <a class="reference internal"href=../api/python/abstract.html#lief.Binary.abstract title=lief.Binary.abstract><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.Binary.abstract</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>ctor_functions</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><a class="reference internal"href=../api/python/abstract.html#lief.Function title=lief.Function><span class=pre>lief.Function</span></a><span class=p><span class=pre>]</span></span></span></span><dd><p>Constructor functions that are called prior to any other functions</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>dex2dex_json_info</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>str</span></span></span><dd></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>dex_files</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary.it_dex_files title=lief.OAT.Binary.it_dex_files><span class=pre>lief.OAT.Binary.it_dex_files</span></a></span></span><dd><p>Return an iterator over <a class="reference internal"href=../api/python/dex.html#lief.DEX.File title=lief.DEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>File</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>dtor_functions</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><a class="reference internal"href=../api/python/abstract.html#lief.Function title=lief.Function><span class=pre>lief.Function</span></a><span class=p><span class=pre>]</span></span></span></span><dd><p>List of the binary destructors (typically, the functions located in the <code class="docutils literal notranslate"><span class=pre>.fini_array</span></code>)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>dynamic_entries</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_dynamic_entries title=lief.ELF.Binary.it_dynamic_entries><span class=pre>lief.ELF.Binary.it_dynamic_entries</span></a></span></span><dd><p>Return an iterator to <a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief.ELF.DynamicEntry><code class="xref py py-class docutils literal notranslate"><span class=pre>DynamicEntry</span></code></a> entries as a list</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>dynamic_relocations</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_filter_relocation title=lief.ELF.Binary.it_filter_relocation><span class=pre>lief.ELF.Binary.it_filter_relocation</span></a></span></span><dd><p>Return an iterator over dynamics <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>Relocation</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>dynamic_symbols</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_symbols title=lief.ELF.Binary.it_symbols><span class=pre>lief.ELF.Binary.it_symbols</span></a></span></span><dd><p>Return an iterator to dynamic <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>entrypoint</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Binary’s entrypoint</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>eof_offset</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Return the last offset used by the ELF binary according to both, the sections table and the segments table.</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>export_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>export_symbol(self,</span> <span class=pre>symbol:</span> <span class=pre>lief._lief.ELF.Symbol)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Symbol</span></code></ol> <p>Export the given symbol and create an entry if it doesn’t exist</p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>export_symbol(self,</span> <span class=pre>symbol_name:</span> <span class=pre>str,</span> <span class=pre>value:</span> <span class=pre>int</span> <span class=pre>=</span> <span class=pre>0)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Symbol</span></code></ol> <p>Export the symbol with the given name and create an entry if it doesn’t exist</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>exported_functions</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><a class="reference internal"href=../api/python/abstract.html#lief.Function title=lief.Function><span class=pre>lief.Function</span></a><span class=p><span class=pre>]</span></span></span></span><dd><p>Return the binary’s exported <a class="reference internal"href=../api/python/abstract.html#lief.Function title=lief.Function><code class="xref py py-class docutils literal notranslate"><span class=pre>Function</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>exported_symbols</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_filter_symbols title=lief.ELF.Binary.it_filter_symbols><span class=pre>lief.ELF.Binary.it_filter_symbols</span></a></span></span><dd><p>Return dynamic <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> which are exported</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>extend</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><span class=pre>lief.ELF.Section</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>extend(self,</span> <span class=pre>segment:</span> <span class=pre>lief._lief.ELF.Segment,</span> <span class=pre>size:</span> <span class=pre>int)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Segment</span></code></ol> <p>Extend the given given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> by the given size</p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>extend(self,</span> <span class=pre>segment:</span> <span class=pre>lief._lief.ELF.Section,</span> <span class=pre>size:</span> <span class=pre>int)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Section</span></code></ol> <p>Extend the given given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> by the given size</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>format</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/abstract.html#lief.Binary.FORMATS title=lief.Binary.FORMATS><span class=pre>lief.Binary.FORMATS</span></a></span></span><dd><p>File format (<a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary.FORMATS title=lief.OAT.Binary.FORMATS><code class="xref py py-class docutils literal notranslate"><span class=pre>FORMATS</span></code></a>) of the underlying binary.</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>functions</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><a class="reference internal"href=../api/python/abstract.html#lief.Function title=lief.Function><span class=pre>lief.Function</span></a><span class=p><span class=pre>]</span></span></span></span><dd><p>List of the functions found the in the binary</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><span class=pre>lief.ELF.Section</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><span class=pre>lief.ELF.Note</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief.ELF.DynamicEntry><span class=pre>lief.ELF.DynamicEntry</span></a><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></span><dd><p>Overloaded function.</p> <ol class=arabic><li><p><code class="docutils literal notranslate"><span class=pre>get(self,</span> <span class=pre>tag:</span> <span class=pre>lief._lief.ELF.DYNAMIC_TAGS)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.DynamicEntry</span></code></p> <blockquote><div><p>Return the first binary’s <a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief.ELF.DynamicEntry><code class="xref py py-class docutils literal notranslate"><span class=pre>DynamicEntry</span></code></a> from the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.DYNAMIC_TAGS title=lief.ELF.DYNAMIC_TAGS><code class="xref py py-class docutils literal notranslate"><span class=pre>DYNAMIC_TAGS</span></code></a>.<p>It returns None if the dynamic entry can’t be found.</div></blockquote><li><p><code class="docutils literal notranslate"><span class=pre>get(self,</span> <span class=pre>type:</span> <span class=pre>lief._lief.ELF.SEGMENT_TYPES)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Segment</span></code></p> <blockquote><div><p>Return the first binary’s <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> from the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.SEGMENT_TYPES title=lief.ELF.SEGMENT_TYPES><code class="xref py py-class docutils literal notranslate"><span class=pre>SEGMENT_TYPES</span></code></a><p>It returns None if the segment can’t be found.</div></blockquote><li><p><code class="docutils literal notranslate"><span class=pre>get(self,</span> <span class=pre>type:</span> <span class=pre>lief._lief.ELF.Note.TYPE)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Note</span></code></p> <blockquote><div><p>Return the first binary’s <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><code class="xref py py-class docutils literal notranslate"><span class=pre>Note</span></code></a> from the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note.TYPE title=lief.ELF.Note.TYPE><code class="xref py py-class docutils literal notranslate"><span class=pre>TYPE</span></code></a>.<p>It returns None if the note can’t be found.</div></blockquote><li><p><code class="docutils literal notranslate"><span class=pre>get(self,</span> <span class=pre>type:</span> <span class=pre>lief._lief.ELF.SECTION_TYPES)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Section</span></code></p> <blockquote><div><p>Return the first binary’s <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> from the given <code class="xref py py-class docutils literal notranslate"><span class=pre>ELF_SECTION_TYPES</span></code><p>It returns None if the section can’t be found.</div></blockquote></ol></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_class</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/oat.html#lief.OAT.Class title=lief.OAT.Class><span class=pre>lief.OAT.Class</span></a></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>get_class(self,</span> <span class=pre>class_name:</span> <span class=pre>str)</span> <span class=pre>-></span> <span class=pre>lief._lief.OAT.Class</span></code></ol> <p>Return the <a class="reference internal"href=../api/python/oat.html#lief.OAT.Class title=lief.OAT.Class><code class="xref py py-class docutils literal notranslate"><span class=pre>Class</span></code></a> from its name</p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>get_class(self,</span> <span class=pre>class_index:</span> <span class=pre>int)</span> <span class=pre>-></span> <span class=pre>lief._lief.OAT.Class</span></code></ol> <p>Return the <a class="reference internal"href=../api/python/oat.html#lief.OAT.Class title=lief.OAT.Class><code class="xref py py-class docutils literal notranslate"><span class=pre>Class</span></code></a> from its <strong>index</strong></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_content_from_virtual_address</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>virtual_address</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em>, <em class=sig-param><span class=n><span class=pre>size</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em>, <em class=sig-param><span class=n><span class=pre>va_type</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES title=lief.Binary.VA_TYPES><span class=pre>lief.Binary.VA_TYPES</span></a></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>memoryview</span></span></span><dd><p>Return the content located at the provided virtual address. The virtual address is specified in the first argument and size to read (in bytes) in the second.</p> <p>If the underlying binary is a PE, one can specify if the virtual address is a <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.RVA title=lief.Binary.VA_TYPES.RVA><code class="xref py py-attr docutils literal notranslate"><span class=pre>RVA</span></code></a> or a <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.VA title=lief.Binary.VA_TYPES.VA><code class="xref py py-attr docutils literal notranslate"><span class=pre>VA</span></code></a>. By default, it is set to <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.AUTO title=lief.Binary.VA_TYPES.AUTO><code class="xref py py-attr docutils literal notranslate"><span class=pre>AUTO</span></code></a>.</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_dynamic_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></span><dd><p>Get the dynamic symbol from the given name.</p> <p>It returns None if it can’t be found.</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_function_address</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>function_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/index.html#lief.lief_errors title=lief.lief_errors><span class=pre>lief.lief_errors</span></a></span></span><dd><p>Return the address of the given function name</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_library</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>library_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntryLibrary title=lief.ELF.DynamicEntryLibrary><span class=pre>lief.ELF.DynamicEntryLibrary</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntryLibrary title=lief.ELF.DynamicEntryLibrary><code class="xref py py-class docutils literal notranslate"><span class=pre>DynamicEntryLibrary</span></code></a> with the given <code class="docutils literal notranslate"><span class=pre>name</span></code></p> <p>It returns None if the library can’t be found.</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_relocation</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><span class=pre>lief.ELF.Relocation</span></a></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>get_relocation(self,</span> <span class=pre>symbol_name:</span> <span class=pre>str)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Relocation</span></code></ol> <p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>Relocation</span></code></a> associated with the given symbol name</p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>get_relocation(self,</span> <span class=pre>symbol:</span> <span class=pre>lief._lief.ELF.Symbol)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Relocation</span></code></ol> <p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>Relocation</span></code></a> associated with the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a></p> <ol class="arabic simple"start=3><li><p><code class="docutils literal notranslate"><span class=pre>get_relocation(self,</span> <span class=pre>address:</span> <span class=pre>int)</span> <span class=pre>-></span> <span class=pre>lief._lief.ELF.Relocation</span></code></ol> <p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>Relocation</span></code></a> associated with the given address</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_section</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>section_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><span class=pre>lief.ELF.Section</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> with the given <code class="docutils literal notranslate"><span class=pre>name</span></code></p> <p>It returns None if the section can’t be found.</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_static_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></span><dd><p>Get the <strong>static</strong> symbol from the given <code class="docutils literal notranslate"><span class=pre>name</span></code>.</p> <p>It returns None if it can’t be found.</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_strings</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>min_size</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><span class=pre>str</span><span class=p><span class=pre>]</span></span></span></span><dd><p>Return list of strings used in the current ELF file with a minimal size given in first parameter (Default: 5) It looks for strings in the <code class="docutils literal notranslate"><span class=pre>.roadata</span></code> section</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>get_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/abstract.html#lief.Symbol title=lief.Symbol><span class=pre>lief.Symbol</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/abstract.html#lief.Symbol title=lief.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> from the given <code class="docutils literal notranslate"><span class=pre>name</span></code>.</p> <p>If the symbol can’t be found, it returns None.</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>gnu_hash</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.GnuHash title=lief.ELF.GnuHash><span class=pre>lief.ELF.GnuHash</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.GnuHash title=lief.ELF.GnuHash><code class="xref py py-class docutils literal notranslate"><span class=pre>GnuHash</span></code></a> object</p> <p>Hash are used by the loader to speed up symbols resolution (GNU Version)</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Overloaded function.</p> <ol class=arabic><li><p><code class="docutils literal notranslate"><span class=pre>has(self,</span> <span class=pre>tag:</span> <span class=pre>lief._lief.ELF.DYNAMIC_TAGS)</span> <span class=pre>-></span> <span class=pre>bool</span></code></p> <blockquote><div><p>Check if it exists a <a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief.ELF.DynamicEntry><code class="xref py py-class docutils literal notranslate"><span class=pre>DynamicEntry</span></code></a> with the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.DYNAMIC_TAGS title=lief.ELF.DYNAMIC_TAGS><code class="xref py py-class docutils literal notranslate"><span class=pre>DYNAMIC_TAGS</span></code></a></div></blockquote><li><p><code class="docutils literal notranslate"><span class=pre>has(self,</span> <span class=pre>type:</span> <span class=pre>lief._lief.ELF.SEGMENT_TYPES)</span> <span class=pre>-></span> <span class=pre>bool</span></code></ol> <p>Check if a <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> of <em>type</em> (<a class="reference internal"href=../api/python/elf.html#lief.ELF.SEGMENT_TYPES title=lief.ELF.SEGMENT_TYPES><code class="xref py py-class docutils literal notranslate"><span class=pre>SEGMENT_TYPES</span></code></a>) exists</p> <ol class="arabic simple"start=3><li><p><code class="docutils literal notranslate"><span class=pre>has(self,</span> <span class=pre>type:</span> <span class=pre>lief._lief.ELF.Note.TYPE)</span> <span class=pre>-></span> <span class=pre>bool</span></code></ol> <p>Check if a <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><code class="xref py py-class docutils literal notranslate"><span class=pre>Note</span></code></a> of <em>type</em> (<a class="reference internal"href=../api/python/elf.html#lief.ELF.Note.TYPE title=lief.ELF.Note.TYPE><code class="xref py py-class docutils literal notranslate"><span class=pre>TYPE</span></code></a>) exists</p> <ol class="arabic simple"start=4><li><p><code class="docutils literal notranslate"><span class=pre>has(self,</span> <span class=pre>type:</span> <span class=pre>lief._lief.ELF.SECTION_TYPES)</span> <span class=pre>-></span> <span class=pre>bool</span></code></ol> <p>Check if a <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> of <em>type</em> (<a class="reference internal"href=../api/python/elf.html#lief.ELF.SECTION_TYPES title=lief.ELF.SECTION_TYPES><code class="xref py py-class docutils literal notranslate"><span class=pre>SECTION_TYPES</span></code></a>) exists</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>has_class</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if the class if the given name is present in the current OAT binary</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has_dynamic_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if the symbol with the given <code class="docutils literal notranslate"><span class=pre>name</span></code> exists in the <strong>dynamic</strong> symbol table</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>has_interpreter</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if the binary uses a loader (also named linker or interpreter)</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has_library</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>library_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if the given library name exists in the current binary</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>has_notes</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p><code class="docutils literal notranslate"><span class=pre>True</span></code> if the binary contains notes</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>has_nx</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if the binary has <code class="docutils literal notranslate"><span class=pre>NX</span></code> protection (non executable stack)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>has_overlay</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>True if data are appended to the end of the binary</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has_section</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>section_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if a <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> with the given name exists in the binary</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has_section_with_offset</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>offset</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if a <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> that encompasses the given offset exists</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has_section_with_va</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>virtual_address</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if a <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> that encompasses the given virtual address exists</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has_static_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if the symbol with the given <code class="docutils literal notranslate"><span class=pre>name</span></code> exists in the <strong>static</strong> symbol table</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>has_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>symbol_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if a <a class="reference internal"href=../api/python/abstract.html#lief.Symbol title=lief.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> with the given name exists</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>header</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/oat.html#lief.OAT.Header title=lief.OAT.Header><span class=pre>lief.OAT.Header</span></a></span></span><dd><p>Return the OAT <a class="reference internal"href=../api/python/oat.html#lief.OAT.Header title=lief.OAT.Header><code class="xref py py-class docutils literal notranslate"><span class=pre>Header</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>imagebase</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Return the program image base. (e.g. <code class="docutils literal notranslate"><span class=pre>0x400000</span></code>)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>imported_functions</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><a class="reference internal"href=../api/python/abstract.html#lief.Function title=lief.Function><span class=pre>lief.Function</span></a><span class=p><span class=pre>]</span></span></span></span><dd><p>Return the binary’s imported <a class="reference internal"href=../api/python/abstract.html#lief.Function title=lief.Function><code class="xref py py-class docutils literal notranslate"><span class=pre>Function</span></code></a> (name)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>imported_symbols</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_filter_symbols title=lief.ELF.Binary.it_filter_symbols><span class=pre>lief.ELF.Binary.it_filter_symbols</span></a></span></span><dd><p>Return dynamic <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> which are imported</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>interpreter</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>str</span></span></span><dd><p>ELF interpreter (loader) if any. (e.g. <code class="docutils literal notranslate"><span class=pre>/lib64/ld-linux-x86-64.so.2</span></code>)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>is_pie</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p>Check if the binary has been compiled with <cite>-fpie -pie</cite> flags</p> <p>To do so we check if there is a <cite>PT_INTERP</cite> segment and if the binary type is <cite>ET_DYN</cite> (Shared object)</p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_classes</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/oat.html#lief.OAT.Class title=lief._lief.OAT.Class><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.OAT.Class</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_dex_files</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/dex.html#lief.DEX.File title=lief._lief.DEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.DEX.File</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_dyn_static_symbols</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief._lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Symbol</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_dynamic_entries</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief._lief.ELF.DynamicEntry><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.DynamicEntry</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_filter_relocation</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief._lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Relocation</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_filter_symbols</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief._lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Symbol</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_methods</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/oat.html#lief.OAT.Method title=lief._lief.OAT.Method><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.OAT.Method</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_notes</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief._lief.ELF.Note><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Note</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_oat_dex_files</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/oat.html#lief.OAT.DexFile title=lief._lief.OAT.DexFile><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.OAT.DexFile</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_relocations</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief._lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Relocation</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_sections</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief._lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Section</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_segments</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief._lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Segment</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_symbols</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief._lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.Symbol</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_symbols_version</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersion title=lief._lief.ELF.SymbolVersion><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.SymbolVersion</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_symbols_version_definition</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersionDefinition title=lief._lief.ELF.SymbolVersionDefinition><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.SymbolVersionDefinition</span></code></a></p></dl> <dl class="py class"><dt class="sig sig-object py"><em class=property><span class=pre>class</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>it_symbols_version_requirement</span></span><dd><p>Iterator over <a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersionRequirement title=lief._lief.ELF.SymbolVersionRequirement><code class="xref py py-class docutils literal notranslate"><span class=pre>lief._lief.ELF.SymbolVersionRequirement</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>last_offset_section</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Return the last offset used in binary according to <strong>sections table</strong></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>last_offset_segment</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Return the last offset used in binary according to <strong>segments table</strong></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>libraries</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><span class=pre>str</span><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><span class=pre>bytes</span><span class=p><span class=pre>]</span></span></span></span><dd><p>Return binary’s imported libraries (name)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>methods</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary.it_methods title=lief.OAT.Binary.it_methods><span class=pre>lief.OAT.Binary.it_methods</span></a></span></span><dd><p>Return an iterator over <a class="reference internal"href=../api/python/oat.html#lief.OAT.Method title=lief.OAT.Method><code class="xref py py-class docutils literal notranslate"><span class=pre>Method</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>next_virtual_address</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Return the next virtual address available</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>notes</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_notes title=lief.ELF.Binary.it_notes><span class=pre>lief.ELF.Binary.it_notes</span></a></span></span><dd><p>Return an iterator over the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><code class="xref py py-class docutils literal notranslate"><span class=pre>Note</span></code></a> entries</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>oat_dex_files</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary.it_oat_dex_files title=lief.OAT.Binary.it_oat_dex_files><span class=pre>lief.OAT.Binary.it_oat_dex_files</span></a></span></span><dd><p>Return an iterator over <a class="reference internal"href=../api/python/oat.html#lief.OAT.DexFile title=lief.OAT.DexFile><code class="xref py py-class docutils literal notranslate"><span class=pre>DexFile</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>object_relocations</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_filter_relocation title=lief.ELF.Binary.it_filter_relocation><span class=pre>lief.ELF.Binary.it_filter_relocation</span></a></span></span><dd><p>Return an iterator over object <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>Relocation</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>offset_to_virtual_address</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>offset</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em>, <em class=sig-param><span class=n><span class=pre>slide</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/index.html#lief.lief_errors title=lief.lief_errors><span class=pre>lief.lief_errors</span></a></span></span><dd><p>Convert an offset into a virtual address.</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>overlay</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>memoryview</span></span></span><dd><p>Overlay data that are not a part of the ELF format</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>patch_address</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Overloaded function.</p> <ol class=arabic><li><p><code class="docutils literal notranslate"><span class=pre>patch_address(self,</span> <span class=pre>address:</span> <span class=pre>int,</span> <span class=pre>patch_value:</span> <span class=pre>list[int],</span> <span class=pre>va_type:</span> <span class=pre>lief._lief.Binary.VA_TYPES</span> <span class=pre>=</span> <span class=pre>lief._lief.VA_TYPES.AUTO)</span> <span class=pre>-></span> <span class=pre>None</span></code></p> <blockquote><div><p>Patch the address with the given list of bytes. The virtual address is specified in the first argument and the content in the second (as a list of bytes).<p>If the underlying binary is a PE, one can specify if the virtual address is a <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.RVA title=lief.Binary.VA_TYPES.RVA><code class="xref py py-attr docutils literal notranslate"><span class=pre>RVA</span></code></a> or a <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.VA title=lief.Binary.VA_TYPES.VA><code class="xref py py-attr docutils literal notranslate"><span class=pre>VA</span></code></a>. By default, it is set to <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.AUTO title=lief.Binary.VA_TYPES.AUTO><code class="xref py py-attr docutils literal notranslate"><span class=pre>AUTO</span></code></a>.</div></blockquote><li><p><code class="docutils literal notranslate"><span class=pre>patch_address(self,</span> <span class=pre>address:</span> <span class=pre>int,</span> <span class=pre>patch_value:</span> <span class=pre>int,</span> <span class=pre>size:</span> <span class=pre>int</span> <span class=pre>=</span> <span class=pre>8,</span> <span class=pre>va_type:</span> <span class=pre>lief._lief.Binary.VA_TYPES</span> <span class=pre>=</span> <span class=pre>lief._lief.VA_TYPES.AUTO)</span> <span class=pre>-></span> <span class=pre>None</span></code></p> <blockquote><div><p>Patch the address with the given integer value. The virtual address is specified in the first argument, the integer in the second and the integer’s size of in third one.<p>If the underlying binary is a PE, one can specify if the virtual address is a <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.RVA title=lief.Binary.VA_TYPES.RVA><code class="xref py py-attr docutils literal notranslate"><span class=pre>RVA</span></code></a> or a <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.VA title=lief.Binary.VA_TYPES.VA><code class="xref py py-attr docutils literal notranslate"><span class=pre>VA</span></code></a>. By default, it is set to <a class="reference internal"href=../api/python/abstract.html#lief.Binary.VA_TYPES.AUTO title=lief.Binary.VA_TYPES.AUTO><code class="xref py py-attr docutils literal notranslate"><span class=pre>AUTO</span></code></a>.</div></blockquote></ol></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>patch_pltgot</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>patch_pltgot(self,</span> <span class=pre>symbol_name:</span> <span class=pre>str,</span> <span class=pre>address:</span> <span class=pre>int)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Patch the imported symbol’s name with the <code class="docutils literal notranslate"><span class=pre>address</span></code></p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>patch_pltgot(self,</span> <span class=pre>symbol:</span> <span class=pre>lief._lief.ELF.Symbol,</span> <span class=pre>address:</span> <span class=pre>int)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Patch the imported <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> with the <code class="docutils literal notranslate"><span class=pre>address</span></code></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>permute_dynamic_symbols</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>permutation</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>list</span><span class=p><span class=pre>[</span></span><span class=pre>int</span><span class=p><span class=pre>]</span></span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Apply the given permutation on the dynamic symbols table</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>pltgot_relocations</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_filter_relocation title=lief.ELF.Binary.it_filter_relocation><span class=pre>lief.ELF.Binary.it_filter_relocation</span></a></span></span><dd><p>Return an iterator over PLT/GOT <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>Relocation</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>relocate_phdr_table</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>type</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.PHDR_RELOC title=lief.ELF.Binary.PHDR_RELOC><span class=pre>lief.ELF.Binary.PHDR_RELOC</span></a></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Force relocating the segments table in a specific way (see: <a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.PHDR_RELOC title=lief.ELF.Binary.PHDR_RELOC><code class="xref py py-class docutils literal notranslate"><span class=pre>PHDR_RELOC</span></code></a>).</p> <p>This function can be used to enforce a specific relocation of the segments table. Upon successful relocation, the function returns the offset of the relocated segments table. Otherwise, if the function fails, it returns 0</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>relocations</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_relocations title=lief.ELF.Binary.it_relocations><span class=pre>lief.ELF.Binary.it_relocations</span></a></span></span><dd><p>Return an iterator over <strong>all</strong> <a class="reference internal"href=../api/python/elf.html#lief.ELF.Relocation title=lief.ELF.Relocation><code class="xref py py-class docutils literal notranslate"><span class=pre>Relocation</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>remove</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>remove(self,</span> <span class=pre>dynamic_entry:</span> <span class=pre>lief._lief.ELF.DynamicEntry)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Remove the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief.ELF.DynamicEntry><code class="xref py py-class docutils literal notranslate"><span class=pre>DynamicEntry</span></code></a> from the dynamic table</p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>remove(self,</span> <span class=pre>tag:</span> <span class=pre>lief._lief.ELF.DYNAMIC_TAGS)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Remove <strong>all</strong> the <a class="reference internal"href=../api/python/elf.html#lief.ELF.DynamicEntry title=lief.ELF.DynamicEntry><code class="xref py py-class docutils literal notranslate"><span class=pre>DynamicEntry</span></code></a> with the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.DYNAMIC_TAGS title=lief.ELF.DYNAMIC_TAGS><code class="xref py py-class docutils literal notranslate"><span class=pre>DYNAMIC_TAGS</span></code></a></p> <ol class="arabic simple"start=3><li><p><code class="docutils literal notranslate"><span class=pre>remove(self,</span> <span class=pre>section:</span> <span class=pre>lief._lief.ELF.Section,</span> <span class=pre>clear:</span> <span class=pre>bool</span> <span class=pre>=</span> <span class=pre>False)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Remove the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a>. The <code class="docutils literal notranslate"><span class=pre>clear</span></code> parameter specifies whether or not we must fill its content with <code class="docutils literal notranslate"><span class=pre>0</span></code> before removing</p> <ol class="arabic simple"start=4><li><p><code class="docutils literal notranslate"><span class=pre>remove(self,</span> <span class=pre>note:</span> <span class=pre>lief._lief.ELF.Note)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Remove the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><code class="xref py py-class docutils literal notranslate"><span class=pre>Note</span></code></a></p> <ol class="arabic simple"start=5><li><p><code class="docutils literal notranslate"><span class=pre>remove(self,</span> <span class=pre>type:</span> <span class=pre>lief._lief.ELF.Note.TYPE)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Remove <strong>all</strong> the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note title=lief.ELF.Note><code class="xref py py-class docutils literal notranslate"><span class=pre>Note</span></code></a> with the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Note.TYPE title=lief.ELF.Note.TYPE><code class="xref py py-class docutils literal notranslate"><span class=pre>TYPE</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>remove_dynamic_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>remove_dynamic_symbol(self,</span> <span class=pre>arg:</span> <span class=pre>lief._lief.ELF.Symbol,</span> <span class=pre>/)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Remove the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> from the <code class="docutils literal notranslate"><span class=pre>.dynsym</span></code> section</p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>remove_dynamic_symbol(self,</span> <span class=pre>arg:</span> <span class=pre>str,</span> <span class=pre>/)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Remove the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> with the name given in parameter from the <code class="docutils literal notranslate"><span class=pre>.dynsym</span></code> section</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>remove_library</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>library_name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Remove the given library</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>remove_section</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>name</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>str</span></span></em>, <em class=sig-param><span class=n><span class=pre>clear</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>bool</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Remove the section with the given name</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>remove_static_symbol</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>arg</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><span class=pre>lief.ELF.Symbol</span></a></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Remove the given <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a> from the <code class="docutils literal notranslate"><span class=pre>.symtab</span></code> section</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>replace</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>new_segment</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></em>, <em class=sig-param><span class=n><span class=pre>original_segment</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></em>, <em class=sig-param><span class=n><span class=pre>base</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></span><dd><p>Replace the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> given in 2nd parameter with the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> given in the first parameter and return the updated segment.</p> <div class="admonition warning"><p class=admonition-title>Warning<p>The <code class="docutils literal notranslate"><span class=pre>original_segment</span></code> is no longer valid after this function</div></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>section_from_offset</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>offset</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em>, <em class=sig-param><span class=n><span class=pre>skip_nobits</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>bool</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><span class=pre>lief.ELF.Section</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> which encompasses the given offset. It returns None if a section can’t be found.</p> <p>If <code class="docutils literal notranslate"><span class=pre>skip_nobits</span></code> is set (which is the case by default), this function won’t consider sections for which the type is <code class="docutils literal notranslate"><span class=pre>SHT_NOBITS</span></code> (like <code class="docutils literal notranslate"><span class=pre>.bss,</span> <span class=pre>.tbss,</span> <span class=pre>...</span></code>)</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>section_from_virtual_address</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>address</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em>, <em class=sig-param><span class=n><span class=pre>skip_nobits</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>bool</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><span class=pre>lief.ELF.Section</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a> which encompasses the given virtual address. It returns None if a section can’t be found.</p> <p>If <code class="docutils literal notranslate"><span class=pre>skip_nobits</span></code> is set (which is the case by default), this function won’t consider sections for which the type is <code class="docutils literal notranslate"><span class=pre>SHT_NOBITS</span></code> (like <code class="docutils literal notranslate"><span class=pre>.bss,</span> <span class=pre>.tbss,</span> <span class=pre>...</span></code>)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>sections</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_sections title=lief.ELF.Binary.it_sections><span class=pre>lief.ELF.Binary.it_sections</span></a></span></span><dd><p>Return an iterator over binary’s <a class="reference internal"href=../api/python/elf.html#lief.ELF.Section title=lief.ELF.Section><code class="xref py py-class docutils literal notranslate"><span class=pre>Section</span></code></a></p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>segment_from_offset</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>offset</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> which encompasses the given offset. It returns None if a segment can’t be found.</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>segment_from_virtual_address</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>address</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><span class=pre>lief.ELF.Segment</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a> which encompasses the given virtual address. It returns None if a segment can’t be found.</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>segments</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_segments title=lief.ELF.Binary.it_segments><span class=pre>lief.ELF.Binary.it_segments</span></a></span></span><dd><p>Return an iterator to binary’s <a class="reference internal"href=../api/python/elf.html#lief.ELF.Segment title=lief.ELF.Segment><code class="xref py py-class docutils literal notranslate"><span class=pre>Segment</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>static_symbols</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_symbols title=lief.ELF.Binary.it_symbols><span class=pre>lief.ELF.Binary.it_symbols</span></a></span></span><dd><p>Return an iterator to static <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>strings</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><span class=pre>str</span><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><span class=pre>bytes</span><span class=p><span class=pre>]</span></span></span></span><dd><p>Return list of strings used in the current ELF file. Basically this function looks for strings in the <code class="docutils literal notranslate"><span class=pre>.roadata</span></code> section</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>strip</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Strip the binary</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>symbols</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_dyn_static_symbols title=lief.ELF.Binary.it_dyn_static_symbols><span class=pre>lief.ELF.Binary.it_dyn_static_symbols</span></a></span></span><dd><p>Return an iterator over both <strong>static</strong> and <strong>dynamic</strong> <a class="reference internal"href=../api/python/elf.html#lief.ELF.Symbol title=lief.ELF.Symbol><code class="xref py py-class docutils literal notranslate"><span class=pre>Symbol</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>symbols_version</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_symbols_version title=lief.ELF.Binary.it_symbols_version><span class=pre>lief.ELF.Binary.it_symbols_version</span></a></span></span><dd><p>Return an iterator <a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersion title=lief.ELF.SymbolVersion><code class="xref py py-class docutils literal notranslate"><span class=pre>SymbolVersion</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>symbols_version_definition</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_symbols_version_definition title=lief.ELF.Binary.it_symbols_version_definition><span class=pre>lief.ELF.Binary.it_symbols_version_definition</span></a></span></span><dd><p>Return an iterator to <a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersionDefinition title=lief.ELF.SymbolVersionDefinition><code class="xref py py-class docutils literal notranslate"><span class=pre>SymbolVersionDefinition</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>symbols_version_requirement</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.Binary.it_symbols_version_requirement title=lief.ELF.Binary.it_symbols_version_requirement><span class=pre>lief.ELF.Binary.it_symbols_version_requirement</span></a></span></span><dd><p>Return an iterator to <a class="reference internal"href=../api/python/elf.html#lief.ELF.SymbolVersionRequirement title=lief.ELF.SymbolVersionRequirement><code class="xref py py-class docutils literal notranslate"><span class=pre>SymbolVersionRequirement</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>sysv_hash</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.SysvHash title=lief.ELF.SysvHash><span class=pre>lief.ELF.SysvHash</span></a></span></span><dd><p>Return the <a class="reference internal"href=../api/python/elf.html#lief.ELF.SysvHash title=lief.ELF.SysvHash><code class="xref py py-class docutils literal notranslate"><span class=pre>SysvHash</span></code></a> object</p> <p>Hash are used by the loader to speed up symbols resolution (SYSV version)</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>type</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><a class="reference internal"href=../api/python/elf.html#lief.ELF.ELF_CLASS title=lief.ELF.ELF_CLASS><span class=pre>lief.ELF.ELF_CLASS</span></a></span></span><dd><p>Return the binary’s <a class="reference internal"href=../api/python/elf.html#lief.ELF.ELF_CLASS title=lief.ELF.ELF_CLASS><code class="xref py py-class docutils literal notranslate"><span class=pre>ELF_CLASS</span></code></a></p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>use_gnu_hash</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p><code class="docutils literal notranslate"><span class=pre>True</span></code> if GNU hash is used</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>use_sysv_hash</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>bool</span></span></span><dd><p><code class="docutils literal notranslate"><span class=pre>True</span></code> if SYSV hash is used</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>virtual_address_to_offset</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>virtual_address</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span><span class=w> </span><span class=p><span class=pre>|</span></span><span class=w> </span><a class="reference internal"href=../api/python/index.html#lief.lief_errors title=lief.lief_errors><span class=pre>lief.lief_errors</span></a></span></span><dd><p>Convert the virtual address to a file offset</p></dl> <dl class="py property"><dt class="sig sig-object py"><em class=property><span class=pre>property</span><span class=w> </span></em><span class="sig-name descname"><span class=pre>virtual_size</span></span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>int</span></span></span><dd><p>Return the size of the mapped binary</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>write</span></span><span class=sig-paren>(</span><em class=sig-param><span class=o><span class=pre>*</span></span><span class=n><span class=pre>args</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>None</span></span></span><dd><p>Overloaded function.</p> <ol class="arabic simple"><li><p><code class="docutils literal notranslate"><span class=pre>write(self,</span> <span class=pre>output:</span> <span class=pre>str)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Rebuild the binary and write it in a file</p> <ol class="arabic simple"start=2><li><p><code class="docutils literal notranslate"><span class=pre>write(self,</span> <span class=pre>output:</span> <span class=pre>str,</span> <span class=pre>config:</span> <span class=pre>lief._lief.ELF.Builder.config_t)</span> <span class=pre>-></span> <span class=pre>None</span></code></ol> <p>Rebuild the binary with the given configuration and write it in a file</p></dl> <dl class="py attribute"><dt class="sig sig-object py"><span class="sig-name descname"><span class=pre>xref</span></span><span class=sig-paren>(</span><em class=sig-param><span class=n><span class=pre>self</span></span></em>, <em class=sig-param><span class=n><span class=pre>virtual_address</span></span><span class=p><span class=pre>:</span></span><span class=w> </span><span class=n><span class=pre>int</span></span></em><span class=sig-paren>)</span> <span class=sig-return><span class=sig-return-icon>→</span> <span class=sig-return-typehint><span class=pre>list</span><span class=p><span class=pre>[</span></span><span class=pre>int</span><span class=p><span class=pre>]</span></span></span></span><dd><p>Return all <strong>virtual addresses</strong> that <em>use</em> the <code class="docutils literal notranslate"><span class=pre>address</span></code> given in parameter</p></dl></dl><p>If the given OAT targets Android Marshmallow or Nougat (6 or 7) then DEX files can be retrieved with the <a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary.dex_files title=lief.OAT.Binary.dex_files><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.OAT.Binary.dex_files</span></code></a> attribute:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=nb>len</span><span class=p>(</span><span class=n>oat</span><span class=o>.</span><span class=n>dex_files</span><span class=p>)</span> <span class=c1># > 1 if multi-dex</span>
<span class=go>1</span>
<span class=gp>>>> </span><span class=n>dex</span> <span class=o>=</span> <span class=n>oat</span><span class=o>.</span><span class=n>dex_files</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=gp>>>> </span><span class=n>dex</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>"/tmp/classes.dex"</span><span class=p>)</span>
</pre></div></div><p>From the code above, the <a class="reference internal"href=../api/python/dex.html#lief.DEX.File title=lief.DEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.DEX.File</span></code></a> has been extracted to <code class="docutils literal notranslate"><span class=pre>/tmp/classes.dex</span></code> (with de-optimization).<p>If the given OAT targets Android Oreo or above, then extraction is done by using the VDEX file. The <a class="reference internal"href=../api/python/oat.html#lief.OAT.parse title=lief.OAT.parse><code class="xref py py-func docutils literal notranslate"><span class=pre>lief.OAT.parse()</span></code></a> function accepts an OAT file or an OAT <strong>and</strong> a VDEX file. By providing the VDEX file in the second parameter, the <a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary title=lief.OAT.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.OAT.Binary</span></code></a> object will have the same functionalities as the one for OAT pre-Oreo.<p>If the VDEX file is not provided then <a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary title=lief.OAT.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.OAT.Binary</span></code></a> will have limited information:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=c1># Without VDEX file</span>
<span class=o>>>></span> <span class=n>oat_oreo</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"KeyChain.odex"</span><span class=p>)</span>
<span class=o>>>></span> <span class=nb>len</span><span class=p>(</span><span class=n>oat_oreo</span><span class=o>.</span><span class=n>dex_files</span><span class=p>)</span>
<span class=mi>0</span>
<span class=o>>>></span> <span class=nb>len</span><span class=p>(</span><span class=n>oat_oreo</span><span class=o>.</span><span class=n>classes</span><span class=p>)</span>
<span class=mi>0</span>
<span class=o>>>></span> <span class=nb>len</span><span class=p>(</span><span class=n>oat_oreo</span><span class=o>.</span><span class=n>oat_dex_files</span><span class=p>)</span>
<span class=mi>1</span>
<span class=o>>>></span> <span class=n>oat_dex_file</span> <span class=o>=</span> <span class=n>oat_oreo</span><span class=o>.</span><span class=n>oat_dex_files</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
<span class=o>>>></span> <span class=nb>print</span><span class=p>(</span><span class=n>oat_dex_file</span><span class=p>)</span>
<span class=o>/</span><span class=n>system</span><span class=o>/</span><span class=n>app</span><span class=o>/</span><span class=n>KeyChain</span><span class=o>/</span><span class=n>KeyChain</span><span class=o>.</span><span class=n>apk</span> <span class=o>-</span> <span class=p>(</span><span class=n>Checksum</span><span class=p>:</span> <span class=mh>0x206c8ab1</span><span class=p>)</span>
</pre></div></div><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=c1># With VDEX file</span>
<span class=o>>>></span> <span class=n>oat_oreo</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>OAT</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"KeyChain.odex"</span><span class=p>,</span> <span class=s2>"KeyChain.vdex"</span><span class=p>)</span>
<span class=o>>>></span> <span class=nb>len</span><span class=p>(</span><span class=n>oat_oreo</span><span class=o>.</span><span class=n>dex_files</span><span class=p>)</span>
<span class=mi>1</span>
<span class=o>>>></span> <span class=nb>len</span><span class=p>(</span><span class=n>oat_oreo</span><span class=o>.</span><span class=n>classes</span><span class=p>)</span>
<span class=mi>17</span>
<span class=o>>>></span> <span class=n>oat_oreo</span><span class=o>.</span><span class=n>dex_files</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>"/tmp/classes.dex"</span><span class=p>)</span>
</pre></div></div><p>We can also use the LIEF’s VDEX module directly:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=n>vdex</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>VDEX</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"KeyChain.vdex"</span><span class=p>)</span>
</pre></div></div><p>As the VDEX format is completely different from OAT, ELF, PE and Mach-O the VDEX parser creates a <a class="reference internal"href=../api/python/vdex.html#lief.VDEX.File title=lief.VDEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.VDEX.File</span></code></a> object and not a <a class="reference internal"href=../api/python/abstract.html#lief.Binary title=lief.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>Binary</span></code></a>. We can also extract DEX files with the <a class="reference internal"href=../api/python/vdex.html#lief.VDEX.File.dex_files title=lief.VDEX.File.dex_files><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.VDEX.File.dex_files</span></code></a> attribute:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=nb>len</span><span class=p>(</span><span class=n>vdex</span><span class=o>.</span><span class=n>dex_files</span><span class=p>)</span>
<span class=go>1</span>
<span class=gp>>>> </span><span class=n>vdex</span><span class=o>.</span><span class=n>dex_files</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s2>"/tmp/KeyChain.dex"</span><span class=p>)</span> <span class=c1># With de-optimization</span>
</pre></div></div></section><section id=dex><h2 id=dex>DEX<a title="Link to this heading"class=headerlink href=#dex>¶</a></h2><p>The previous part was about the OAT/VDEX formats and how to access to the underlying DEX. This part introduces the main API for the <a class="reference internal"href=../api/python/dex.html#lief.DEX.File title=lief.DEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.DEX.File</span></code></a> object.<p>The LIEF DEX module enables to get information about Java code such as String, classes name, dalvik bytecodes, …<div class="admonition note"><p class=admonition-title>Note<p>As LIEF project is only focused on formats, there won’t be Dalvik disassembler in the DEX module.</div><p>The main API for a DEX file is in the <a class="reference internal"href=../api/python/dex.html#lief.DEX.File title=lief.DEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.DEX.File</span></code></a> object. This object can be generated using:<blockquote><div><ul class=simple><li><p><a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary.dex_files title=lief.OAT.Binary.dex_files><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.OAT.Binary.dex_files</span></code></a><li><p><a class="reference internal"href=../api/python/vdex.html#lief.VDEX.File.dex_files title=lief.VDEX.File.dex_files><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.VDEX.File.dex_files</span></code></a><li><p><a class="reference internal"href=../api/python/dex.html#lief.DEX.parse title=lief.DEX.parse><code class="xref py py-func docutils literal notranslate"><span class=pre>lief.DEX.parse()</span></code></a></ul></div></blockquote><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=n>oat</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"SecSettings2.odex"</span><span class=p>)</span>
<span class=gp>>>> </span><span class=nb>type</span><span class=p>(</span><span class=n>oat</span><span class=o>.</span><span class=n>dex_files</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
<span class=go>_pylief.DEX.File</span>

<span class=gp>>>> </span><span class=n>vdex</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>VDEX</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"SecSettings2.odex"</span><span class=p>)</span>
<span class=gp>>>> </span><span class=nb>type</span><span class=p>(</span><span class=n>vdex</span><span class=o>.</span><span class=n>dex_files</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
<span class=go>_pylief.DEX.File</span>

<span class=gp>>>> </span><span class=n>dex</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>DEX</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"classes.dex"</span><span class=p>)</span>
<span class=gp>>>> </span><span class=nb>type</span><span class=p>(</span><span class=n>dex</span><span class=p>)</span>
<span class=go>_pylief.DEX.File</span>
</pre></div></div><p>Once created, we can access to the strings with the <a class="reference internal"href=../api/python/dex.html#lief.DEX.File.strings title=lief.DEX.File.strings><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.DEX.File.strings</span></code></a> attribute:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=gp>>>> </span><span class=nb>len</span><span class=p>(</span><span class=n>dex</span><span class=o>.</span><span class=n>strings</span><span class=p>)</span>
<span class=go>23529</span>
<span class=gp>>>> </span><span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>dex</span><span class=o>.</span><span class=n>strings</span><span class=p>:</span>
<span class=gp>... </span>  <span class=k>if</span> <span class=n>http</span> <span class=ow>in</span> <span class=n>s</span><span class=p>:</span>
<span class=gp>... </span>    <span class=nb>print</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>

<span class=go>https://analytics.mopub.com/i/jot/exchange_client_event</span>
<span class=go>https://app-measurement.com/a</span>
<span class=go>https://mobilecrashreporting.googleapis.com/v1/crashes:batchCreate?key=</span>
<span class=go>https://pagead2.googlesyndication.com/pagead/gen_204?id=gmob-apps</span>
<span class=go>https://plus.google.com/</span>
<span class=go>https://ssl.google-analytics.com</span>
<span class=go>https://support.google.com/dfp_premium/answer/7160685#push</span>
<span class=go>https://www.google.com</span>
<span class=go>...</span>
</pre></div></div><p>Similarly, methods and classes are available with the <a class="reference internal"href=../api/python/dex.html#lief.DEX.File.classes title=lief.DEX.File.classes><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.DEX.File.classes</span></code></a> / <a class="reference internal"href=../api/python/dex.html#lief.DEX.File.methods title=lief.DEX.File.methods><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.DEX.File.methods</span></code></a> attributes:<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=k>for</span> <span class=bp>cls</span> <span class=ow>in</span> <span class=n>dex</span><span class=o>.</span><span class=n>classes</span><span class=p>:</span>
  <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>source_filename</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=bp>cls</span><span class=p>)</span>
</pre></div></div><div class="highlight-text notranslate"><div class=highlight><pre><span></span>com.avast.android.sdk.antitheft.internal.protection.wipe.a - CalendarWiper.java - 3 Methods
com.avast.android.account.internal.identity.a - AvastIdentityProvider.java - 17 Methods
com.avast.android.account.internal.identity.d - FacebookIdentityProvider.java - 19 Methods
com.avast.android.lib.wifiscanner.internal.b$a - WifiScannerComponentFactory.java - 1 Methods
</pre></div></div><p>In the DEX file format, there is a special attribute for classes that register the original source filename: <a class="reference external"href=https://source.android.com/devices/tech/dalvik/dex-format#class-def-item>source_file_idx</a>. Some <em>obfuscators</em> mangle classes but keep this attribute! Since Java source filenames are associated with class names, we can easily recover the deobfuscated name using:<blockquote><div><ul class=simple><li><p><a class="reference internal"href=../api/python/dex.html#lief.DEX.Class.source_filename title=lief.DEX.Class.source_filename><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.DEX.Class.source_filename</span></code></a><li><p><a class="reference internal"href=../api/python/dex.html#lief.DEX.Class.pretty_name title=lief.DEX.Class.pretty_name><code class="xref py py-attr docutils literal notranslate"><span class=pre>lief.DEX.Class.pretty_name</span></code></a></ul></div></blockquote><div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=k>for</span> <span class=bp>cls</span> <span class=ow>in</span> <span class=n>dex</span><span class=o>.</span><span class=n>classes</span><span class=p>:</span>
  <span class=k>if</span> <span class=bp>cls</span><span class=o>.</span><span class=n>source_filename</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=bp>cls</span><span class=o>.</span><span class=n>pretty_name</span> <span class=o>+</span> <span class=s2>": ---> "</span> <span class=o>+</span> <span class=bp>cls</span><span class=o>.</span><span class=n>source_filename</span><span class=p>)</span>
</pre></div></div><div class="highlight-text notranslate"><div class=highlight><pre><span></span>com.avast.android.sdk.antitheft.internal.protection.wipe.a: ---> CalendarWiper.java
com.avast.android.account.internal.identity.a               ---> AvastIdentityProvider.java
com.avast.android.account.internal.identity.d               ---> FacebookIdentityProvider.java
com.avast.android.lib.wifiscanner.internal.b$a              ---> WifiScannerComponentFactory.java


If we are interested with DEX methods, they are represented with the :class:`~lief.DEX.Method` object and we can access to the **raw** Dalvik bytecode through :attr:`lief.DEX.Method.bytecode`
</pre></div></div></section><section id=art><h2 id=art>ART<a title="Link to this heading"class=headerlink href=#art>¶</a></h2><p><strong>ART</strong> is the name of the <strong>Android Runtime</strong> but it’s also a <strong>format</strong>! This format is used for optimization purpose by the Android’s <strong>framework</strong>.<p>As discussed previously, Android has its own implementation of the Java virtual based on the Dalvik bytecode. This JVM is implemented in C++ and Java primitives (<code class="docutils literal notranslate"><span class=pre>java.lang.String</span></code>, <code class="docutils literal notranslate"><span class=pre>java.lang.Object</span></code>, etc) are mirrored with C++ objects:<ul class=simple><li><p><code class="docutils literal notranslate"><span class=pre>java.lang.Class</span></code>: <code class="docutils literal notranslate"><span class=pre>art::mirror::Class</span></code><li><p><code class="docutils literal notranslate"><span class=pre>java.lang.String</span></code>: <code class="docutils literal notranslate"><span class=pre>art::mirror::String</span></code><li><p><code class="docutils literal notranslate"><span class=pre>java.lang.reflect.Method</span></code>: <code class="docutils literal notranslate"><span class=pre>art::mirror::Method</span></code><li><p>…</ul><p>When instantiating a <strong>new</strong> Java class, it creates a mirrored C++ object (Memory allocation, calling constructors, …) and the JVM handles a reference on this C++ object. To speed up the boot process and to avoid instantiation of well-known classes <a class="footnote-reference brackets"href=#id10 id=id8 role=doc-noteref><span class=fn-bracket>[</span>2<span class=fn-bracket>]</span></a> at each boot, Android uses the ART format to store instances of C++ objects. To simplify, it can be seen as a heap dump of C++ objects.<p>In the same way as OAT and VDEX, the internal structures of this format change for each version of Android.<p>LIEF 0.9 has a very basic support for this format and only exposes the ART <a class="reference internal"href=../api/python/art.html#lief.ART.Header title=lief.ART.Header><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.ART.Header</span></code></a>. The main API is available in the <a class="reference internal"href=../api/python/art.html#lief.ART.File title=lief.ART.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.ART.File</span></code></a> object.<div class="highlight-python notranslate"><div class=highlight><pre><span></span><span class=n>art</span> <span class=o>=</span> <span class=n>lief</span><span class=o>.</span><span class=n>ART</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s2>"boot.art"</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>art</span><span class=o>.</span><span class=n>header</span><span class=p>)</span>
</pre></div></div><div class="highlight-text notranslate"><div class=highlight><pre><span></span>Version:                         46
Image Begin:                     0x70000000
Image Size:                      0x238ac8
Checksum:                        0x997c0fb0
OAT File Begin:                  0x70a5b000
OAT File End:                    0x71272000
OAT Data Begin:                  0x70a5c000
OAT Data End:                    0x7126df70
Patch Delta:                     0
Pointer Size:                    8
Compile pic:                     true
Number of sections:              10
Number of methods:               7
Boot Image Begin:                0
Boot Image Size:                 0
Boot OAT Begin:                  0
Boot OAT Size:                   0
Storage Mode:                    UNCOMPRESSED
Data Size:                       0x2389f0
</pre></div></div></section><section id=oatlastword><h2 id=oatlastword>oatlastword<a title="Link to this heading"class=headerlink href=#oatlastword>¶</a></h2><p>LIEF 0.9 is <em>read-only</em> on these formats but further versions should enable to modify them (Add methods, change names, patch checksum, …)<p>Enjoy!<p class=rubric>Notes<aside class="footnote-list brackets"><aside class="footnote brackets"id=id9 role=doc-footnote><span class=label><span class=fn-bracket>[</span><a href=#id1 role=doc-backlink>1</a><span class=fn-bracket>]</span></span><ul class=simple><li><p><a class="reference external"href=http://mylifewithandroid.blogspot.com/2009/05/about-quick-method-invocation.html>http://mylifewithandroid.blogspot.com/2009/05/about-quick-method-invocation.html</a><li><p><a class="reference external"href=https://github.com/JesusFreke/smali/wiki/UnresolvableOdexInstruction>https://github.com/JesusFreke/smali/wiki/UnresolvableOdexInstruction</a></ul></aside><aside class="footnote brackets"id=id10 role=doc-footnote><span class=label><span class=fn-bracket>[</span><a href=#id8 role=doc-backlink>2</a><span class=fn-bracket>]</span></span><p>Usually the ones from the Android Framework</aside><aside class="footnote brackets"id=id11 role=doc-footnote><span class=label><span class=fn-bracket>[</span><a href=#id5 role=doc-backlink>3</a><span class=fn-bracket>]</span></span><p>They have other nices features like a disassembler, pseudo-code, … that are not cover in LIEF</aside><aside class="footnote brackets"id=id12 role=doc-footnote><span class=label><span class=fn-bracket>[</span>4<span class=fn-bracket>]</span></span><span class=backrefs>(<a href=#id2 role=doc-backlink>1</a>,<a href=#id6 role=doc-backlink>2</a>)</span><p>Dextra by Jonathan Levin: <a class="reference external"href=http://newandroidbook.com/tools/dextra.html>http://newandroidbook.com/tools/dextra.html</a></aside><aside class="footnote brackets"id=id13 role=doc-footnote><span class=label><span class=fn-bracket>[</span>5<span class=fn-bracket>]</span></span><span class=backrefs>(<a href=#id3 role=doc-backlink>1</a>,<a href=#id7 role=doc-backlink>2</a>)</span><p>vdexExtractor by Anestis Bechtsoudis: <a class="reference external"href=https://github.com/anestisb/vdexExtractor>https://github.com/anestisb/vdexExtractor</a></aside><aside class="footnote brackets"id=id14 role=doc-footnote><span class=label><span class=fn-bracket>[</span><a href=#id4 role=doc-backlink>6</a><span class=fn-bracket>]</span></span><p>smali by JesusFreke: <a class="reference external"href=https://github.com/JesusFreke/smali/wiki/DeodexInstructions>https://github.com/JesusFreke/smali/wiki/DeodexInstructions</a></aside></aside><p class=rubric>API<ul class=simple><li><p><a class="reference internal"href=../api/python/oat.html#lief.OAT.Binary title=lief.OAT.Binary><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.OAT.Binary</span></code></a><li><p><a class="reference internal"href=../api/python/vdex.html#lief.VDEX.File title=lief.VDEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.VDEX.File</span></code></a><li><p><a class="reference internal"href=../api/python/dex.html#lief.DEX.File title=lief.DEX.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.DEX.File</span></code></a><li><p><a class="reference internal"href=../api/python/art.html#lief.ART.File title=lief.ART.File><code class="xref py py-class docutils literal notranslate"><span class=pre>lief.ART.File</span></code></a></ul></section></section></div><div class="col-xl-2 d-none d-xl-block px-0 py-5 docs-sidebar docs-sidebar-right"><aside class="border-left pl-5 py-3"><span class="text-uppercase text-muted font-size-sm d-block mb-3"> On this page: </span><a class="d-block my-2"data-toggle=scroll href=#introduction>Introduction</a><a class="d-block my-2"data-toggle=scroll href=#the-missing-dex>The Missing DEX</a><a class="d-block my-2"data-toggle=scroll href=#oat-and-vdex>OAT and VDEX</a><a class="d-block my-2"data-toggle=scroll href=#dex>DEX</a><a class="d-block my-2"data-toggle=scroll href=#art>ART</a><a class="d-block my-2"data-toggle=scroll href=#oatlastword>oatlastword</a></aside></div></div></div>